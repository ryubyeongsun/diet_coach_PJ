# 개발 일지 (2025년 12월 10일)

## 1. 작업 목표

- **1차 목표**: 프론트엔드 기본 기능 구현 및 백엔드 API 연동.
- **2차 목표**: 1차 구현을 기반으로 식단 페이지를 고도화하고, 상세 데이터를 표시하는 대시보드 및 쇼핑 페이지 연동 기능 추가.

---

## 2. 완료된 작업

### 가. 1차: API 연동 및 기본 기능 구현
- **공통 API 클라이언트**: `axios` 인스턴스를 중앙화하고, 요청/응답을 일괄 처리하는 인터셉터를 구현하여 API 통신 기반을 마련했습니다.
- **API 모듈 구현**: `usersApi`, `mealPlanApi`, `shoppingApi` 모듈을 통해 백엔드 API를 호출할 수 있도록 함수를 구현했습니다.
    - 특히 `mealPlanApi.js`는 `fetchDayDetail`, `fetchPlanIngredients` 등 상세 API 함수를 추가/수정하여 최신 PRD에 맞게 보완했습니다.
- **페이지별 기능 구현**:
    - **MealPlanPage**: 사용자 자동 생성/유지, 최신 식단 조회, 식단 자동 생성 기능의 기본 골격을 구현했습니다.
    - **ShoppingPage**: 식재료 검색 및 추천 기능을 연동하고 결과를 화면에 표시하는 기본 UI를 확인했습니다.

### 나. 2차: 식단 페이지 고도화 및 쇼핑 연동
- **식단 상세 모달 구현**:
    - `src/components/meal/MealPlanDayModal.vue` 컴포넌트를 신규 생성하여, 특정 날짜의 식단 상세 정보(아침/점심/저녁/간식 메뉴 및 칼로리)를 모달 형태로 표시하도록 구현했습니다.
    - `MealPlanCalendar.vue`의 각 날짜 카드 클릭 시 이벤트를 발생시키고, `MealPlanPage.vue`에서 이 이벤트를 받아 모달을 띄우도록 연동했습니다.
- **식단 통계 대시보드**:
    - `MealPlanPage.vue`에 `computed` 속성을 사용하여, 식단 데이터를 기반으로 **평균 섭취 칼로리** 및 **목표 달성률**을 동적으로 계산합니다.
    - 계산된 통계 값을 포함하는 3개의 통계 카드(기간/목표, 평균 섭취량, 달성률) UI를 `MealPlanPage.vue` 상단에 추가하여 대시보드 기능을 구현했습니다.
- **캘린더 컴포넌트 리팩토링**: `MealPlanCalendar.vue`가 더미 데이터 대신, `props`로 실제 `days` 배열 데이터를 받아 각 날짜 카드를 렌더링하고, 날짜 형식을 'MM/DD(요일)'로 변환하여 표시하도록 수정했습니다.
- **쇼핑 페이지 연동**:
    - `MealPlanPage.vue`에 '이 식단 재료 장보기' 버튼을 추가하고, 클릭 시 현재 식단(`mealPlanId`)을 쿼리 파라미터로 포함하여 `/shopping` 페이지로 이동하도록 구현했습니다.
    - `ShoppingPage.vue`에서 URL의 `planId` 쿼리 파라미터를 읽어, 해당 식단에 필요한 재료 목록을 `fetchPlanIngredients` API로 조회하여 페이지 상단에 표시합니다.
    - 재료 목록의 각 항목 옆에 '이 재료 상품 찾기' 버튼을 추가하여, 클릭 시 해당 재료로 기존 검색 기능을 재사용하여 상품을 검색하도록 구현했습니다. 이 과정에서 `ShoppingSearchBar.vue` 컴포넌트를 `v-model` 지원 방식으로 리팩토링했습니다.
- **코드 정리**: 디버깅 과정에서 추가했던 불필요한 `console.log`를 제거하여 코드의 가독성을 향상시켰습니다.

---

## 3. 주요 이슈 및 해결 과정

초기 API 연동 및 고도화 과정에서 발생한 주요 이슈들을 해결하여 안정성을 확보했습니다.

- **이슈 1: 사용자 생성 시 이메일 중복 오류**
    - **원인**: `localStorage` 초기화 후, 고정된 이메일로 사용자 생성을 재시도하여 발생.
    - **해결**: 사용자 생성 시 `Date.now()`를 조합한 고유 이메일을 사용하도록 수정.

- **이슈 2: 사용자 ID 처리 방식 불일치 (`NaN` 오류)**
    - **원인**: 프론트엔드는 사용자 정보 객체를 예상했으나, 백엔드는 생성된 `userId`만 숫자로 직접 반환.
    - **해결**: 백엔드 응답에 맞춰, 반환된 숫자 값을 `userId`로 즉시 사용하도록 로직 수정.

- **이슈 3: 신규 사용자의 식단 조회 오류**
    - **원인**: 식단이 없는 신규 사용자의 식단 조회 시, 백엔드가 반환하는 `400 Bad Request`를 프론트엔드가 일반 오류로 처리.
    - **해결**: 해당 응답 메시지를 정상적인 시나리오로 간주, 오류 메시지 대신 "생성된 식단이 없습니다"라는 안내 문구가 표시되도록 예외 처리 로직 수정.

- **이슈 4: `MealPlanDayModal.vue` 파일 임포트 오류**
    - **원인**: `MealPlanDayModal.vue` 파일을 잘못된 경로(`프로젝트루트/src` 대신 `frontend/src`)에 생성하여 발생.
    - **해결**: 파일 내용을 복사하여 올바른 경로(`frontend/src/components/meal/MealPlanDayModal.vue`)에 다시 생성.

- **이슈 5: '이 식단 재료 장보기' 버튼 무반응**
    - **원인**: 식단 객체 내 플랜 ID 필드명이 프론트엔드 코드(`planId`)와 백엔드 응답(`mealPlanId`) 간에 불일치.
    - **해결**: `MealPlanPage.vue`에서 `overview.value.planId`를 `overview.value.mealPlanId`로 수정.

- **이슈 6: 쇼핑 페이지에서 식단 재료 목록이 빈칸으로 표시**
    - **원인**: `GET /api/meal-plans/{planId}/ingredients` API의 응답 데이터 필드명(`ingredient`, `neededGram`)이 프론트엔드 코드의 예상(`ingredientName`, `totalCalories`, `daysCount`)과 불일치.
    - **해결**: `ShoppingPage.vue` 템플릿에서 필드명을 실제 백엔드 응답에 맞춰 `ing.ingredient`, `ing.neededGram`으로 수정.

---

## 4. 결론

오늘 작업을 통해 프론트엔드는 단순 API 연동 수준을 넘어, **동적 데이터를 계산하고 시각화하는 대시보드 형태**로 발전했습니다. 초기 구현부터 두 차례의 고도화 요청, 그리고 그 과정에서 발생한 수많은 이슈 해결까지 성공적으로 마무리하여 프로젝트의 안정성과 완성도를 크게 높였습니다. 최종적으로, 모든 기능이 PRD에 명시된 대로 사용자에게 직관적이고 풍부한 경험을 제공하도록 구현되었습니다.
